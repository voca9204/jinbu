<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¶€ì•”ë™ ê±´ì¶• ì ê²€ ë³´ê³ ì„œ - Firebase + LocalStorage í•˜ì´ë¸Œë¦¬ë“œ</title>
    
    <!-- Firebase v11.6.0 ìµœì‹  Modular SDK -->
    <script type="module">
        // Firebase v11.6.0 Modular API ë¶ˆëŸ¬ì˜¤ê¸°
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js';
        import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from 'https://www.gstatic.com/firebasejs/11.6.0/firebase-storage.js';
        import { getFirestore, collection, addDoc, doc, deleteDoc, onSnapshot, query, orderBy, serverTimestamp, getDocs } from 'https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js';
        
        // Firebase ì„¤ì • (ì‹¤ì œ í”„ë¡œì íŠ¸ ì—°ê²°ë¨)
        const firebaseConfig = {
            apiKey: "AIzaSyACCbVD7LT2istfACwJhthp7dYWbTutgz4",
            authDomain: "personal-564df.firebaseapp.com",
            projectId: "personal-564df",
            storageBucket: "personal-564df.firebasestorage.app",
            messagingSenderId: "1016556488732",
            appId: "1:1016556488732:web:06bf11f1be63a4242d77d9",
            
            // Firebase í™œì„±í™”
            disabled: false // ì‹¤ì œ Firebase í”„ë¡œì íŠ¸ ì—°ê²°ë¨
        };

        // Firebase ì´ˆê¸°í™” (ì¡°ê±´ë¶€)
        let firebaseEnabled = false;
        
        if (!firebaseConfig.disabled && firebaseConfig.apiKey !== "AIzaSyDQGQGQGQGQGQGQGQGQGQGQGQGQGQGQG") {
            try {
                const app = initializeApp(firebaseConfig);
                const storage = getStorage(app);
                const firestore = getFirestore(app);

                // ì „ì—­ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •
                window.firebaseStorage = storage;
                window.firebaseFirestore = firestore;
                window.firebaseModules = {
                    ref, uploadBytes, getDownloadURL, deleteObject,
                    collection, addDoc, doc, deleteDoc, serverTimestamp
                };
                
                firebaseEnabled = true;
                console.log("ğŸ”¥ Firebase v11.6.0 ì´ˆê¸°í™” ì™„ë£Œ (í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“œ)");
            } catch (error) {
                console.warn("âš ï¸ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨, ë¡œì»¬ ì „ìš© ëª¨ë“œë¡œ ì „í™˜:", error.message);
                firebaseEnabled = false;
            }
        } else {
            console.log("ğŸ“± ë¡œì»¬ ì „ìš© ëª¨ë“œ (Firebase ë¹„í™œì„±í™”)");
            firebaseEnabled = false;
        }
        
        // Firebase ìƒíƒœë¥¼ ì „ì—­ì— ì €ì¥
        window.firebaseEnabled = firebaseEnabled;
    </script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        
        .section {
            margin-bottom: 40px;
        }
        
        .section-title {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .landlord-section .section-title {
            background: linear-gradient(135deg, #3742fa, #2f3542);
        }
        
        .tenant-section .section-title {
            background: linear-gradient(135deg, #5f27cd, #341f97);
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid #e0e0e0;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .card-number {
            background: #007bff;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .stars {
            font-size: 18px;
            color: #ffd700;
        }
        
        .image-gallery {
            margin-bottom: 15px;
        }
        
        .image-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .btn-primary {
            background: #007bff;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0056b3;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #545b62;
        }
        
        .hidden {
            display: none !important;
        }
        
        .carousel-container {
            position: relative;
            width: 100%;
            max-height: 200px;
            overflow: hidden;
            border-radius: 6px;
            background: #f8f9fa;
            display: none;
        }
        
        .carousel-track {
            display: flex;
            transition: transform 0.3s ease;
        }
        
        .carousel-slide {
            min-width: 100%;
            position: relative;
        }
        
        .carousel-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: none;
        }
        
        .carousel-nav.prev {
            left: 10px;
        }
        
        .carousel-nav.next {
            right: 10px;
        }
        
        .carousel-container:hover .carousel-nav {
            display: block;
        }
        
        .image-delete {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(220, 53, 69, 0.8);
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
        }
        
        .image-counter {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .card-description {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .summary {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .data-controls {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .data-controls h3 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .data-controls .btn {
            margin: 5px;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        /* Lightbox ìŠ¤íƒ€ì¼ */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            cursor: pointer;
        }
        
        .lightbox.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 90%;
            cursor: default;
        }
        
        .lightbox-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            max-width: 90vw;
            max-height: 90vh;
        }
        
        .lightbox-close {
            position: absolute;
            top: -40px;
            right: 0;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .lightbox-close:hover {
            background: white;
        }
        
        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .lightbox-nav:hover {
            background: white;
        }
        
        .lightbox-nav.prev {
            left: -60px;
        }
        
        .lightbox-nav.next {
            right: -60px;
        }
        
        .lightbox-info {
            position: absolute;
            bottom: -40px;
            left: 0;
            right: 0;
            color: white;
            text-align: center;
            font-size: 14px;
        }
        
        .carousel-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .carousel-image:hover {
            transform: scale(1.02);
        }
        
        @media (max-width: 768px) {
            .cards-grid {
                grid-template-columns: 1fr;
            }
            
            .image-controls {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ë¶€ì•”ë™ ê±´ì¶• ì ê²€ ë³´ê³ ì„œ</h1>
        
        <!-- ë°ì´í„° ê´€ë¦¬ ì»¨íŠ¸ë¡¤ -->
        <div class="data-controls">
            <h3>ğŸ“± ë°ì´í„° ê´€ë¦¬ (í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“œ)</h3>
            <div style="margin-bottom: 15px;">
                <div id="firebase-status" style="padding: 8px; border-radius: 4px; background: #e8f5e8; color: #2d5016; font-weight: bold;">
                    ğŸ”„ Firebase ì—°ê²° ì¤‘...
                </div>
            </div>
            <button class="btn btn-secondary" onclick="exportData()">ğŸ’¾ ë°ì´í„° ë°±ì—…</button>
            <button class="btn btn-primary" onclick="importData()">ğŸ“¥ ë°ì´í„° ë³µì›</button>
            <button class="btn btn-danger" onclick="clearAllData()">ğŸ—‘ï¸ ëª¨ë“  ë°ì´í„° ì‚­ì œ</button>
            <div style="margin-top: 10px; font-size: 12px; color: #666;">
                * ì‚¬ì§„ì€ ë¸Œë¼ìš°ì €(LocalStorage) + Firebase Storageì— ì´ì¤‘ ì €ì¥ë©ë‹ˆë‹¤.<br>
                * ì˜¤í”„ë¼ì¸ì—ì„œë„ ì‘ë™í•˜ë©°, ì˜¨ë¼ì¸ì‹œ ìë™ìœ¼ë¡œ í´ë¼ìš°ë“œ ë°±ì—…ë©ë‹ˆë‹¤.
            </div>
        </div>
        
        <!-- ì„ëŒ€ì¸ í˜‘ì˜ì‚¬í•­ -->
        <div class="section landlord-section">
            <div class="section-title">ğŸ  ì„ëŒ€ì¸ í˜‘ì˜ì‚¬í•­ (13ê°œ í•­ëª©)</div>
            
            <div class="cards-grid">
                <!-- ë³„í‘œ 5ê°œ: â­â­â­â­â­ -->
                <div class="card" data-card-id="landlord-1">
                    <div class="card-header">
                        <div class="card-number">1</div>
                        <div class="stars">â­â­â­â­â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-1" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-1')">
                        <input type="file" id="cameraInput-landlord-1" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-1')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-1').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-1').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-1">
                            <div class="carousel-track" id="carousel-landlord-1"></div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-1')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-1')">â€º</button>
                            <div class="image-counter" id="counter-landlord-1">0/0</div>
                        </div>
                    </div>
                    <div class="card-title">ê±´ë¬¼ì™¸ë²½ ê³°íŒ¡ì´ ì²­ì†Œ</div>
                    <div class="card-description">ê±´ë¬¼ ì™¸ë²½ì— ë°œìƒí•œ ê³°íŒ¡ì´ë¡œ ì¸í•œ ê±´ê°• ë° êµ¬ì¡°ì  ìœ„í—˜</div>
                </div>
                
                <div class="card" data-card-id="landlord-2">
                    <div class="card-header">
                        <div class="card-number">2</div>
                        <div class="stars">â­â­â­â­â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-2" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-2')">
                        <input type="file" id="cameraInput-landlord-2" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-2')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-2').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-2').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-2">
                            <div class="carousel-track" id="carousel-landlord-2">
                            </div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-2')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-2')">â€º</button>
                            <div class="image-counter" id="counter-landlord-2">1/1</div>
                        </div>
                    </div>
                    <div class="card-title">ê³„ë‹¨ ë‚œê°„ ì†ì¡ì´ ì„¤ì¹˜</div>
                    <div class="card-description">ê³„ë‹¨ ì•ˆì „ì„ ìœ„í•œ ë‚œê°„ ì†ì¡ì´ ë³´ìˆ˜ ë° ì„¤ì¹˜</div>
                </div>
                
                <div class="card" data-card-id="landlord-3">
                    <div class="card-header">
                        <div class="card-number">3</div>
                        <div class="stars">â­â­â­â­â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-3" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-3')">
                        <input type="file" id="cameraInput-landlord-3" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-3')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-3').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-3').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-3">
                            <div class="carousel-track" id="carousel-landlord-3">
                            </div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-3')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-3')">â€º</button>
                            <div class="image-counter" id="counter-landlord-3">1/1</div>
                        </div>
                    </div>
                    <div class="card-title">2ì¸µ í™”ì¥ì‹¤ ì²œì¥ ëˆ„ìˆ˜</div>
                    <div class="card-description">2ì¸µ í™”ì¥ì‹¤ ì²œì¥ ëˆ„ìˆ˜ í™•ì¸ ë° ë°©ìˆ˜ ë³´ìˆ˜</div>
                </div>
                
                <div class="card" data-card-id="landlord-4">
                    <div class="card-header">
                        <div class="card-number">4</div>
                        <div class="stars">â­â­â­â­â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-4" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-4')">
                        <input type="file" id="cameraInput-landlord-4" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-4')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-4').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-4').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-4">
                            <div class="carousel-track" id="carousel-landlord-4">
                            </div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-4')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-4')">â€º</button>
                            <div class="image-counter" id="counter-landlord-4">1/1</div>
                        </div>
                    </div>
                    <div class="card-title">1ì¸µ ë°”ë‹¥ ë³´ìˆ˜</div>
                    <div class="card-description">1ì¸µ ë°”ë‹¥ì˜ ì‹¬ê°í•œ íŒŒì† ë¶€ë¶„ ê¸´ê¸‰ ë³´ìˆ˜</div>
                </div>
                
                <div class="card" data-card-id="landlord-5">
                    <div class="card-header">
                        <div class="card-number">5</div>
                        <div class="stars">â­â­â­â­â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-5" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-5')">
                        <input type="file" id="cameraInput-landlord-5" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-5')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-5').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-5').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-5">
                            <div class="carousel-track" id="carousel-landlord-5">
                            </div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-5')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-5')">â€º</button>
                            <div class="image-counter" id="counter-landlord-5">1/1</div>
                        </div>
                    </div>
                    <div class="card-title">2ì¸µ ë°”ë‹¥ ë³´ìˆ˜</div>
                    <div class="card-description">2ì¸µ ë°”ë‹¥ ê· ì—´ ë° ì†ìƒ ë¶€ë¶„ ë³´ìˆ˜</div>
                </div>
                
                <!-- ë³„í‘œ 4ê°œ: â­â­â­â­ -->
                <div class="card" data-card-id="landlord-6">
                    <div class="card-header">
                        <div class="card-number">6</div>
                        <div class="stars">â­â­â­â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-6" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-6')">
                        <input type="file" id="cameraInput-landlord-6" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-6')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-6').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-6').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-6">
                            <div class="carousel-track" id="carousel-landlord-6">
                            </div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-6')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-6')">â€º</button>
                            <div class="image-counter" id="counter-landlord-6">1/1</div>
                        </div>
                    </div>
                    <div class="card-title">4ì¸µ í™”ì¥ì‹¤ ë°”ë‹¥ ëˆ„ìˆ˜</div>
                    <div class="card-description">4ì¸µ í™”ì¥ì‹¤ ë°”ë‹¥ ëˆ„ìˆ˜ í™•ì¸ ë° ë³´ìˆ˜</div>
                </div>
                
                <div class="card" data-card-id="landlord-7">
                    <div class="card-header">
                        <div class="card-number">7</div>
                        <div class="stars">â­â­â­â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-7" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-7')">
                        <input type="file" id="cameraInput-landlord-7" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-7')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-7').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-7').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-7">
                            <div class="carousel-track" id="carousel-landlord-7"></div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-7')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-7')">â€º</button>
                            <div class="image-counter" id="counter-landlord-7">0/0</div>
                        </div>
                    </div>
                    <div class="card-title">ì¡°ê²½ ì •ë¦¬</div>
                    <div class="card-description">ê±´ë¬¼ ì£¼ë³€ ì¡°ê²½ ì •ë¦¬ ë° í™˜ê²½ ê°œì„  ì‘ì—…</div>
                </div>
                
                <!-- ë³„í‘œ 3ê°œ: â­â­â­ -->
                <div class="card" data-card-id="landlord-8">
                    <div class="card-header">
                        <div class="card-number">8</div>
                        <div class="stars">â­â­â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-8" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-8')">
                        <input type="file" id="cameraInput-landlord-8" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-8')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-8').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-8').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-8">
                            <div class="carousel-track" id="carousel-landlord-8">
                            </div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-8')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-8')">â€º</button>
                            <div class="image-counter" id="counter-landlord-8">1/1</div>
                        </div>
                    </div>
                    <div class="card-title">2ì¸µ í´ë”©ë„ì–´ ìœ ê²©1</div>
                    <div class="card-description">2ì¸µ í´ë”©ë„ì–´ì˜ ìœ ê²© ì¡°ì • ë° ë³´ìˆ˜</div>
                </div>
                
                <div class="card" data-card-id="landlord-9">
                    <div class="card-header">
                        <div class="card-number">9</div>
                        <div class="stars">â­â­â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-9" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-9')">
                        <input type="file" id="cameraInput-landlord-9" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-9')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-9').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-9').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-9">
                            <div class="carousel-track" id="carousel-landlord-9">
                            </div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-9')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-9')">â€º</button>
                            <div class="image-counter" id="counter-landlord-9">1/1</div>
                        </div>
                    </div>
                    <div class="card-title">2ì¸µ í´ë”©ë„ì–´ ìœ ê²©2</div>
                    <div class="card-description">2ì¸µ í´ë”©ë„ì–´ì˜ ì¶”ê°€ ìœ ê²© ë¬¸ì œ í•´ê²°</div>
                </div>
                
                <!-- ë³„í‘œ 2ê°œ: â­â­ -->
                <div class="card" data-card-id="landlord-10">
                    <div class="card-header">
                        <div class="card-number">10</div>
                        <div class="stars">â­â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-10" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-10')">
                        <input type="file" id="cameraInput-landlord-10" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-10')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-10').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-10').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-10">
                            <div class="carousel-track" id="carousel-landlord-10"></div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-10')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-10')">â€º</button>
                            <div class="image-counter" id="counter-landlord-10">0/0</div>
                        </div>
                    </div>
                    <div class="card-title">ê±´ë¬¼ ì™¸ë¶€ ì¡°ëª… ì ê²€</div>
                    <div class="card-description">ê±´ë¬¼ ì™¸ë¶€ ì¡°ëª… ì‹œì„¤ ì ê²€ ë° êµì²´</div>
                </div>
                
                <!-- ë³„í‘œ 1ê°œ: â­ -->
                <div class="card" data-card-id="landlord-11">
                    <div class="card-header">
                        <div class="card-number">11</div>
                        <div class="stars">â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-11" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-11')">
                        <input type="file" id="cameraInput-landlord-11" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-11')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-11').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-11').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-11">
                            <div class="carousel-track" id="carousel-landlord-11">
                            </div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-11')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-11')">â€º</button>
                            <div class="image-counter" id="counter-landlord-11">1/1</div>
                        </div>
                    </div>
                    <div class="card-title">ìŠ¤ìœ„ì¹˜ ì ê²€</div>
                    <div class="card-description">ì „ê¸° ìŠ¤ìœ„ì¹˜ ì‘ë™ ìƒíƒœ ì ê²€ ë° êµì²´</div>
                </div>
                
                <div class="card" data-card-id="landlord-12">
                    <div class="card-header">
                        <div class="card-number">12</div>
                        <div class="stars">â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-12" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-12')">
                        <input type="file" id="cameraInput-landlord-12" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-12')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-12').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-12').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-12">
                            <div class="carousel-track" id="carousel-landlord-12">
                            </div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-12')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-12')">â€º</button>
                            <div class="image-counter" id="counter-landlord-12">1/1</div>
                        </div>
                    </div>
                    <div class="card-title">í†µì‹ í•¨ ì»¤ë²„</div>
                    <div class="card-description">í†µì‹ í•¨ ì»¤ë²„ ë³´ìˆ˜ ë° êµì²´</div>
                </div>
                
                <div class="card" data-card-id="landlord-13">
                    <div class="card-header">
                        <div class="card-number">13</div>
                        <div class="stars">â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-landlord-13" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'landlord-13')">
                        <input type="file" id="cameraInput-landlord-13" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'landlord-13')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-landlord-13').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-landlord-13').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-landlord-13">
                            <div class="carousel-track" id="carousel-landlord-13">
                            </div>
                            <button class="carousel-nav prev" onclick="prevImage('landlord-13')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('landlord-13')">â€º</button>
                            <div class="image-counter" id="counter-landlord-13">1/1</div>
                        </div>
                    </div>
                    <div class="card-title">ê³„ë‹¨ ì†ì¡ì´ ë³´ìˆ˜</div>
                    <div class="card-description">ê¸°ì¡´ ê³„ë‹¨ ì†ì¡ì´ ë¶€ì‹ í™•ì¸ ë° ë³´ìˆ˜</div>
                </div>
            </div>
        </div>
        
        <!-- ì „ì„ì°¨ì¸ í˜‘ì˜ì‚¬í•­ -->
        <div class="section tenant-section">
            <div class="section-title">ğŸ‘¤ ì „ì„ì°¨ì¸ í˜‘ì˜ì‚¬í•­ (1ê°œ í•­ëª©)</div>
            
            <div class="cards-grid">
                <div class="card" data-card-id="tenant-1">
                    <div class="card-header">
                        <div class="card-number">1</div>
                        <div class="stars">â­</div>
                    </div>
                    <div class="image-gallery">
                        <input type="file" id="fileInput-tenant-1" class="hidden" accept="image/*" multiple onchange="handleFileUpload(event, 'tenant-1')">
                        <input type="file" id="cameraInput-tenant-1" class="hidden" accept="image/*" capture="environment" onchange="handleFileUpload(event, 'tenant-1')">
                        <div class="image-controls">
                            <button class="btn btn-primary" onclick="document.getElementById('fileInput-tenant-1').click()">ğŸ“· ì‚¬ì§„ ì¶”ê°€</button>
                            <button class="btn btn-secondary" onclick="document.getElementById('cameraInput-tenant-1').click()">ğŸ“¸ ì¹´ë©”ë¼</button>
                        </div>
                        <div class="carousel-container" id="container-tenant-1">
                            <div class="carousel-track" id="carousel-tenant-1"></div>
                            <button class="carousel-nav prev" onclick="prevImage('tenant-1')">â€¹</button>
                            <button class="carousel-nav next" onclick="nextImage('tenant-1')">â€º</button>
                            <div class="image-counter" id="counter-tenant-1">0/0</div>
                        </div>
                    </div>
                    <div class="card-title">ì¹´í˜ ë°”í…Œì´ë¸” ì²˜ë¦¬</div>
                    <div class="card-description">ì „ì„ì°¨ì¸ì´ ì„¤ì¹˜í•œ ì¹´í˜ ë°”í…Œì´ë¸” ì² ê±° ì¡°ê±´ í˜‘ì˜</div>
                </div>
            </div>
        </div>
        
        <div class="summary">
            <h2>ğŸ“‹ ì ê²€ ìš”ì•½</h2>
            <p>ì´ 14ê°œ í•­ëª© | ì„ëŒ€ì¸ í˜‘ì˜ 13ê°œ | ì „ì„ì°¨ì¸ í˜‘ì˜ 1ê°œ</p>
            <p><strong>ë³„í‘œë³„ ë¶„ë¥˜:</strong> â­â­â­â­â­(5ê°œ) > â­â­â­â­(2ê°œ) > â­â­â­(2ê°œ) > â­â­(1ê°œ) > â­(4ê°œ)</p>
        </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox" onclick="closeLightbox()">
        <div class="lightbox-content" onclick="event.stopPropagation()">
            <button class="lightbox-close" onclick="closeLightbox()">Ã—</button>
            <button class="lightbox-nav prev" onclick="prevLightboxImage()">â€¹</button>
            <button class="lightbox-nav next" onclick="nextLightboxImage()">â€º</button>
            <img class="lightbox-image" id="lightbox-image" src="" alt="">
            <div class="lightbox-info" id="lightbox-info"></div>
        </div>
    </div>

    <script>
        // ì´ë¯¸ì§€ ê´€ë¦¬ ê°ì²´ - localStorageì™€ ë™ê¸°í™”
        let imageData = {};
        
        // LocalStorage í‚¤
        const STORAGE_KEY = 'jinbu-image-data';
        
        // Lightbox ê´€ë ¨ ë³€ìˆ˜
        let currentLightboxCardId = null;
        let currentLightboxIndex = 0;
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë³µì›
        function loadDataFromStorage() {
            try {
                const stored = localStorage.getItem(STORAGE_KEY);
                if (stored) {
                    imageData = JSON.parse(stored);
                    console.log('ë°ì´í„° ë³µì›ë¨:', imageData);
                    
                    // íŒŒì¼ëª… ë§ˆì´ê·¸ë ˆì´ì…˜ (ì˜› íŒŒì¼ëª… â†’ ìƒˆ íŒŒì¼ëª…)
                    let needsUpdate = false;
                    Object.keys(imageData).forEach(cardId => {
                        if (imageData[cardId]) {
                            imageData[cardId].forEach(img => {
                                if (img.src) {
                                    const oldSrc = img.src;
                                    // íŒŒì¼ëª… ë³€ê²½ ë§¤í•‘
                                    img.src = img.src.replace('01_ìŠ¤ìœ„ì¹˜.jpg', '01_switch.jpg');
                                    img.src = img.src.replace('02_í†µì‹ í•¨ì»¤ë²„.jpg', '02_communication.jpg');
                                    
                                    if (oldSrc !== img.src) {
                                        console.log('íŒŒì¼ëª… ë§ˆì´ê·¸ë ˆì´ì…˜:', oldSrc, 'â†’', img.src);
                                        needsUpdate = true;
                                    }
                                }
                            });
                        }
                    });
                    
                    // ë§ˆì´ê·¸ë ˆì´ì…˜ì´ ë°œìƒí–ˆìœ¼ë©´ ì €ì¥
                    if (needsUpdate) {
                        saveDataToStorage();
                        console.log('íŒŒì¼ëª… ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ');
                    }
                    
                    // ëª¨ë“  ì¹´ë“œì˜ ì´ë¯¸ì§€ í‘œì‹œ
                    Object.keys(imageData).forEach(cardId => {
                        updateCarousel(cardId);
                    });
                }
            } catch (error) {
                console.error('ë°ì´í„° ë³µì› ì‹¤íŒ¨:', error);
                imageData = {};
            }
        }
        
        // LocalStorage ìš©ëŸ‰ ì²´í¬ í•¨ìˆ˜
        function checkStorageQuota() {
            try {
                const testKey = 'storage-test';
                const testData = new Array(1024 * 1024).join('a'); // 1MB í…ŒìŠ¤íŠ¸
                localStorage.setItem(testKey, testData);
                localStorage.removeItem(testKey);
                return true;
            } catch (e) {
                return false;
            }
        }

        // ë°ì´í„°ë¥¼ localStorageì— ì €ì¥ (ê°œì„ ëœ ë²„ì „)
        function saveDataToStorage() {
            try {
                // í˜„ì¬ ë°ì´í„° í¬ê¸° ê³„ì‚°
                const dataString = JSON.stringify(imageData);
                const sizeInMB = (dataString.length / 1024 / 1024).toFixed(2);
                console.log(`ë°ì´í„° í¬ê¸°: ${sizeInMB}MB`);
                
                // 5MB ì´ìƒì´ë©´ ê²½ê³ 
                if (sizeInMB > 5) {
                    console.warn('âš ï¸ ë°ì´í„° í¬ê¸°ê°€ 5MBë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ì¼ë¶€ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.');
                    updateFirebaseStatus(`âš ï¸ ë¡œì»¬ ë°ì´í„° í¬ê¸°: ${sizeInMB}MB (ê¶Œì¥: 5MB ì´í•˜)`, true);
                }
                
                localStorage.setItem(STORAGE_KEY, dataString);
                console.log('ë°ì´í„° ì €ì¥ë¨');
            } catch (error) {
                console.error('ë°ì´í„° ì €ì¥ ì‹¤íŒ¨:', error);
                
                if (error.name === 'QuotaExceededError') {
                    // ìš©ëŸ‰ ì´ˆê³¼ì‹œ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼
                    alert('ğŸ’¾ ì €ì¥ ê³µê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤!\n\ní•´ê²° ë°©ë²•:\n1. ì¼ë¶€ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ì„¸ìš”\n2. ë¸Œë¼ìš°ì € ìºì‹œë¥¼ ì •ë¦¬í•˜ì„¸ìš”\n3. ë°ì´í„° ë°±ì—… í›„ "ëª¨ë“  ë°ì´í„° ì‚­ì œ"ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”');
                    updateFirebaseStatus('âŒ LocalStorage ìš©ëŸ‰ ì´ˆê³¼ - ì´ë¯¸ì§€ ì‚­ì œ í•„ìš”', true);
                    
                    // ìš©ëŸ‰ ì´ˆê³¼ì‹œ ë§ˆì§€ë§‰ ì¶”ê°€ëœ ì´ë¯¸ì§€ë“¤ ì œê±° ì‹œë„
                    if (confirm('ìë™ìœ¼ë¡œ ìµœê·¼ ì¶”ê°€ëœ ì´ë¯¸ì§€ë“¤ì„ ì œê±°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        autoCleanupImages();
                    }
                } else {
                    updateFirebaseStatus('âŒ ë°ì´í„° ì €ì¥ ì‹¤íŒ¨', true);
                    alert('ë°ì´í„° ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì €ì¥ ê³µê°„ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                }
            }
        }

        // ìë™ ì •ë¦¬ í•¨ìˆ˜
        function autoCleanupImages() {
            try {
                let cleaned = false;
                
                // ê° ì¹´ë“œì—ì„œ ê°€ì¥ ìµœê·¼ ì´ë¯¸ì§€ ì œê±°
                for (const cardId in imageData) {
                    if (imageData[cardId] && imageData[cardId].length > 1) {
                        imageData[cardId].pop(); // ë§ˆì§€ë§‰ ì´ë¯¸ì§€ ì œê±°
                        updateCarousel(cardId);
                        cleaned = true;
                    }
                }
                
                if (cleaned) {
                    saveDataToStorage(); // ì¬ì‹œë„
                    alert('ì¼ë¶€ ì´ë¯¸ì§€ê°€ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    alert('ì œê±°í•  ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•´ì£¼ì„¸ìš”.');
                }
            } catch (error) {
                console.error('ìë™ ì •ë¦¬ ì‹¤íŒ¨:', error);
            }
        }

        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        // Firebase ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateFirebaseStatus(status, isError = false) {
            const statusElement = document.getElementById('firebase-status');
            if (statusElement) {
                statusElement.textContent = status;
                statusElement.style.background = isError ? '#ffe8e8' : '#e8f5e8';
                statusElement.style.color = isError ? '#d63031' : '#2d5016';
            }
        }

        // Firebase Storageì— ì´ë¯¸ì§€ ì—…ë¡œë“œ
        async function uploadToFirebase(file, cardId) {
            try {
                const { ref, uploadBytes, getDownloadURL, collection, addDoc, serverTimestamp } = window.firebaseModules;
                const storage = window.firebaseStorage;
                const firestore = window.firebaseFirestore;
                
                // íŒŒì¼ëª… ìƒì„± (ê³ ìœ ì„±ì„ ìœ„í•´ timestamp ì¶”ê°€)
                const timestamp = new Date().getTime();
                const fileName = `${cardId}_${timestamp}_${file.name}`;
                const storageRef = ref(storage, `jinbu-images/${fileName}`);
                
                // Firebase Storageì— ì—…ë¡œë“œ
                console.log('Firebase ì—…ë¡œë“œ ì‹œì‘:', fileName);
                const snapshot = await uploadBytes(storageRef, file);
                const downloadURL = await getDownloadURL(storageRef);
                
                // Firestoreì— ë©”íƒ€ë°ì´í„° ì €ì¥
                const imageDoc = {
                    cardId: cardId,
                    fileName: file.name,
                    originalFileName: file.name,
                    storageFileName: fileName,
                    downloadURL: downloadURL,
                    uploadedAt: serverTimestamp(),
                    fileSize: file.size,
                    fileType: file.type
                };
                
                const docRef = await addDoc(collection(firestore, 'jinbu-images'), imageDoc);
                console.log('Firebase ì—…ë¡œë“œ ì™„ë£Œ:', downloadURL);
                
                return {
                    firebaseUrl: downloadURL,
                    firebaseId: fileName,
                    docId: docRef.id
                };
                
            } catch (error) {
                console.error('Firebase ì—…ë¡œë“œ ì‹¤íŒ¨:', error);
                updateFirebaseStatus('âŒ Firebase ì—…ë¡œë“œ ì‹¤íŒ¨: ' + error.message, true);
                return null;
            }
        }

        // ì´ë¯¸ì§€ ì••ì¶• í•¨ìˆ˜ (LocalStorage ìš©ëŸ‰ ìµœì í™”)
        function compressImage(file, maxWidth = 800, quality = 0.7) {
            return new Promise((resolve) => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = function() {
                    // ë¹„ìœ¨ ìœ ì§€í•˜ë©° ë¦¬ì‚¬ì´ì¦ˆ
                    const ratio = Math.min(maxWidth / img.width, maxWidth / img.height);
                    canvas.width = img.width * ratio;
                    canvas.height = img.height * ratio;
                    
                    // ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    
                    // ì••ì¶•ëœ ë°ì´í„° URL ë°˜í™˜
                    const compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
                    console.log(`ì´ë¯¸ì§€ ì••ì¶•: ${file.name} (ì›ë³¸: ${(file.size/1024).toFixed(1)}KB â†’ ì••ì¶•: ${(compressedDataUrl.length*0.75/1024).toFixed(1)}KB)`);
                    resolve(compressedDataUrl);
                };
                
                const reader = new FileReader();
                reader.onload = (e) => img.src = e.target.result;
                reader.readAsDataURL(file);
            });
        }

        function handleFileUpload(event, cardId) {
            console.log('handleFileUpload called for:', cardId);
            const files = Array.from(event.target.files);
            console.log('Files selected:', files.length);
            
            files.forEach(async (file) => {
                console.log('Processing file:', file.name);
                
                // 1. ì´ë¯¸ì§€ ì••ì¶• (LocalStorage ìš©ëŸ‰ ìµœì í™”)
                const compressedSrc = await compressImage(file);
                
                // 2. ì¦‰ì‹œ ë¡œì»¬ì— ì¶”ê°€ (ë¹ ë¥¸ ì‘ë‹µ)
                console.log('File compressed, adding to carousel');
                const localImageData = {
                    src: compressedSrc, // ì••ì¶•ëœ ì´ë¯¸ì§€ ì‚¬ìš©
                    name: file.name,
                    timestamp: new Date().toISOString(),
                    isLocal: true,
                    firebaseUrl: null,
                    firebaseId: null,
                    docId: null
                };
                addImageToCarousel(cardId, localImageData);
                
                // 2. Firebaseì— ë°±ê·¸ë¼ìš´ë“œ ì—…ë¡œë“œ (í™œì„±í™”ë˜ì–´ ìˆì„ ë•Œë§Œ)
                if (window.firebaseEnabled) {
                    try {
                        updateFirebaseStatus('ğŸ”„ Firebase ì—…ë¡œë“œ ì¤‘...');
                        const firebaseData = await uploadToFirebase(file, cardId);
                        
                        if (firebaseData && imageData[cardId]) {
                            // ë¡œì»¬ ë°ì´í„°ì— Firebase ì •ë³´ ì¶”ê°€
                            const localImages = imageData[cardId];
                            const targetImage = localImages.find(img => 
                                img.name === file.name && img.isLocal && !img.firebaseUrl
                            );
                            
                            if (targetImage) {
                                targetImage.firebaseUrl = firebaseData.firebaseUrl;
                                targetImage.firebaseId = firebaseData.firebaseId;
                                targetImage.docId = firebaseData.docId;
                                targetImage.isLocal = false; // ì´ì œ Firebaseì—ë„ ì €ì¥ë¨
                                console.log('Firebase ë°ì´í„° ì—°ê²° ì™„ë£Œ:', targetImage);
                            }
                            
                            saveDataToStorage(); // LocalStorage ì—…ë°ì´íŠ¸
                            updateFirebaseStatus('âœ… Firebase ë™ê¸°í™” ì™„ë£Œ');
                        } else {
                            updateFirebaseStatus('âš ï¸ Firebase ì—…ë¡œë“œ ì‹¤íŒ¨ (ë¡œì»¬ ì €ì¥ì€ ì™„ë£Œ)', true);
                        }
                    } catch (firebaseError) {
                        console.error('Firebase ì—…ë¡œë“œ ì‹¤íŒ¨:', firebaseError);
                        
                        // Firebase ì‹¤íŒ¨ ì›ì¸ë³„ ë©”ì‹œì§€
                        let errorMessage = 'âš ï¸ Firebase ì—…ë¡œë“œ ì‹¤íŒ¨: ';
                        if (firebaseError.code === 'storage/unauthorized') {
                            errorMessage += 'ê¶Œí•œ ì—†ìŒ (ë¡œì»¬ ì €ì¥ì€ ì™„ë£Œ)';
                        } else if (firebaseError.code === 'storage/quota-exceeded') {
                            errorMessage += 'ìš©ëŸ‰ ì´ˆê³¼ (ë¡œì»¬ ì €ì¥ì€ ì™„ë£Œ)';
                        } else {
                            errorMessage += 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ (ë¡œì»¬ ì €ì¥ì€ ì™„ë£Œ)';
                        }
                        
                        updateFirebaseStatus(errorMessage, true);
                        console.log('ğŸ”„ ë¡œì»¬ ì €ì¥ì€ ì •ìƒ ì‘ë™ ì¤‘ (ì˜¤í”„ë¼ì¸ ëª¨ë“œ)');
                    }
                } else {
                    updateFirebaseStatus('ğŸ“± ë¡œì»¬ ì „ìš© ëª¨ë“œ (Firebase ë¹„í™œì„±í™”)', false);
                    console.log('ğŸ“± ë¡œì»¬ ì „ìš©ìœ¼ë¡œ ì €ì¥ ì™„ë£Œ');
                }
            });
            
            // íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™”
            event.target.value = '';
        }

        // ì¹´ëŸ¬ì…€ì— ì´ë¯¸ì§€ ì¶”ê°€ (ìˆ˜ì •ëœ ë²„ì „)
        function addImageToCarousel(cardId, newImageData) {
            if (!imageData[cardId]) {
                imageData[cardId] = [];
            }
            
            imageData[cardId].push(newImageData);
            
            updateCarousel(cardId);
            saveDataToStorage(); // ë°ì´í„° ì €ì¥
        }

        // ì¹´ëŸ¬ì…€ ì—…ë°ì´íŠ¸
        function updateCarousel(cardId) {
            const carousel = document.getElementById(`carousel-${cardId}`);
            const container = document.getElementById(`container-${cardId}`);
            const images = imageData[cardId] || [];
            
            if (!carousel || !container) {
                console.error('Carousel elements not found for:', cardId);
                return;
            }
            
            carousel.innerHTML = '';
            
            images.forEach((image, index) => {
                const slide = document.createElement('div');
                slide.className = 'carousel-slide';
                slide.innerHTML = `
                    <img src="${image.src}" alt="${image.name}" class="carousel-image" onclick="openLightbox('${cardId}', ${index})" title="í´ë¦­í•˜ì—¬ ì›ë³¸ ë³´ê¸°">
                    <button class="image-delete" onclick="deleteImage('${cardId}', ${index})" title="ì‚­ì œ">Ã—</button>
                `;
                carousel.appendChild(slide);
            });
            
            // ì»¨í…Œì´ë„ˆ í‘œì‹œ
            if (images.length > 0) {
                container.style.display = 'block';
            } else {
                container.style.display = 'none';
            }
            
            updateImageCounter(cardId);
        }

        // ì´ë¯¸ì§€ ì‚­ì œ
        // Firebaseì—ì„œ ì´ë¯¸ì§€ ì‚­ì œ
        async function deleteFromFirebase(imageInfo) {
            try {
                if (!imageInfo.firebaseId || !imageInfo.docId) {
                    console.log('Firebase ì •ë³´ê°€ ì—†ì–´ ë¡œì»¬ì—ì„œë§Œ ì‚­ì œ');
                    return true;
                }
                
                const { ref, deleteObject, doc, deleteDoc } = window.firebaseModules;
                const storage = window.firebaseStorage;
                const firestore = window.firebaseFirestore;
                
                // Firebase Storageì—ì„œ ì‚­ì œ
                const storageRef = ref(storage, `jinbu-images/${imageInfo.firebaseId}`);
                await deleteObject(storageRef);
                console.log('Firebase Storage ì‚­ì œ ì™„ë£Œ:', imageInfo.firebaseId);
                
                // Firestoreì—ì„œ ì‚­ì œ
                await deleteDoc(doc(firestore, 'jinbu-images', imageInfo.docId));
                console.log('Firestore ë¬¸ì„œ ì‚­ì œ ì™„ë£Œ:', imageInfo.docId);
                
                return true;
            } catch (error) {
                console.error('Firebase ì‚­ì œ ì‹¤íŒ¨:', error);
                updateFirebaseStatus('âš ï¸ Firebase ì‚­ì œ ì‹¤íŒ¨ (ë¡œì»¬ì—ì„œëŠ” ì‚­ì œë¨)', true);
                return false;
            }
        }

        async function deleteImage(cardId, index) {
            if (imageData[cardId] && imageData[cardId][index]) {
                const imageInfo = imageData[cardId][index];
                const confirmDelete = confirm('ì´ ì‚¬ì§„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ë¡œì»¬ + Firebaseì—ì„œ ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤)');
                
                if (confirmDelete) {
                    // 1. Firebaseì—ì„œ ì‚­ì œ ì‹œë„
                    updateFirebaseStatus('ğŸ”„ Firebase ì‚­ì œ ì¤‘...');
                    await deleteFromFirebase(imageInfo);
                    
                    // 2. ë¡œì»¬ì—ì„œ ì‚­ì œ
                    imageData[cardId].splice(index, 1);
                    updateCarousel(cardId);
                    saveDataToStorage(); // ë°ì´í„° ì €ì¥
                    
                    updateFirebaseStatus('âœ… ì‚­ì œ ì™„ë£Œ');
                }
            }
        }

        // ì´ì „ ì´ë¯¸ì§€
        function prevImage(cardId) {
            const carousel = document.getElementById(`carousel-${cardId}`);
            const images = imageData[cardId] || [];
            if (images.length <= 1) return;
            
            if (!carousel.dataset.currentIndex) {
                carousel.dataset.currentIndex = '0';
            }
            
            let currentIndex = parseInt(carousel.dataset.currentIndex);
            currentIndex = currentIndex > 0 ? currentIndex - 1 : images.length - 1;
            carousel.dataset.currentIndex = currentIndex.toString();
            
            carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
            updateImageCounter(cardId);
        }

        // ë‹¤ìŒ ì´ë¯¸ì§€
        function nextImage(cardId) {
            const carousel = document.getElementById(`carousel-${cardId}`);
            const images = imageData[cardId] || [];
            if (images.length <= 1) return;
            
            if (!carousel.dataset.currentIndex) {
                carousel.dataset.currentIndex = '0';
            }
            
            let currentIndex = parseInt(carousel.dataset.currentIndex);
            currentIndex = currentIndex < images.length - 1 ? currentIndex + 1 : 0;
            carousel.dataset.currentIndex = currentIndex.toString();
            
            carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
            updateImageCounter(cardId);
        }

        // ì´ë¯¸ì§€ ì¹´ìš´í„° ì—…ë°ì´íŠ¸
        function updateImageCounter(cardId) {
            const counter = document.getElementById(`counter-${cardId}`);
            const carousel = document.getElementById(`carousel-${cardId}`);
            const images = imageData[cardId] || [];
            
            if (!counter || !carousel) return;
            
            if (images.length > 0) {
                const currentIndex = parseInt(carousel.dataset.currentIndex || '0') + 1;
                counter.textContent = `${currentIndex}/${images.length}`;
                counter.style.display = 'block';
            } else {
                counter.textContent = '0/0';
                counter.style.display = 'none';
            }
        }
        
        // ë°ì´í„° ë°±ì—… (JSON íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ)
        function exportData() {
            try {
                const dataStr = JSON.stringify(imageData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `jinbu-backup-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
                URL.revokeObjectURL(url);
                alert('ë°ì´í„°ê°€ ë°±ì—…ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                console.error('ë°±ì—… ì‹¤íŒ¨:', error);
                alert('ë°±ì—…ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ë°ì´í„° ë³µì› ë²„íŠ¼ í´ë¦­
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        const confirmImport = confirm('ê¸°ì¡´ ë°ì´í„°ë¥¼ ëª¨ë‘ êµì²´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
                        if (confirmImport) {
                            imageData = importedData;
                            saveDataToStorage();
                            location.reload(); // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ìœ¼ë¡œ ë°ì´í„° ì ìš©
                        }
                    } catch (error) {
                        console.error('ë³µì› ì‹¤íŒ¨:', error);
                        alert('ì˜ëª»ëœ ë°±ì—… íŒŒì¼ì…ë‹ˆë‹¤.');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }
        
        // ëª¨ë“  ë°ì´í„° ì‚­ì œ
        function clearAllData() {
            const confirmClear = confirm('ëª¨ë“  ì‚¬ì§„ê³¼ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(ë¡œì»¬ ì €ì¥ì†Œë§Œ ì‚­ì œë©ë‹ˆë‹¤. Firebase ë°ì´í„°ëŠ” ìˆ˜ë™ìœ¼ë¡œ ì‚­ì œí•´ì£¼ì„¸ìš”)\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            if (confirmClear) {
                const doubleConfirm = confirm('ì •ë§ë¡œ ëª¨ë“  ë¡œì»¬ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
                if (doubleConfirm) {
                    imageData = {};
                    saveDataToStorage();
                    updateFirebaseStatus('âš ï¸ ë¡œì»¬ ë°ì´í„°ë§Œ ì‚­ì œë¨ (Firebase ë°ì´í„°ëŠ” ìœ ì§€)', true);
                    location.reload();
                }
            }
        }
        
        // Lightbox ì—´ê¸°
        function openLightbox(cardId, imageIndex) {
            const images = imageData[cardId] || [];
            if (images.length === 0) return;
            
            currentLightboxCardId = cardId;
            currentLightboxIndex = imageIndex;
            
            const lightbox = document.getElementById('lightbox');
            const lightboxImage = document.getElementById('lightbox-image');
            const lightboxInfo = document.getElementById('lightbox-info');
            
            // ì´ë¯¸ì§€ ì„¤ì •
            const image = images[imageIndex];
            lightboxImage.src = image.src;
            lightboxImage.alt = image.name;
            
            // ì •ë³´ ì„¤ì •
            lightboxInfo.textContent = `${image.name} (${imageIndex + 1}/${images.length})`;
            
            // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
            const prevBtn = lightbox.querySelector('.lightbox-nav.prev');
            const nextBtn = lightbox.querySelector('.lightbox-nav.next');
            
            if (images.length > 1) {
                prevBtn.style.display = 'flex';
                nextBtn.style.display = 'flex';
            } else {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
            }
            
            // Lightbox í‘œì‹œ
            lightbox.classList.add('active');
            document.body.style.overflow = 'hidden'; // ìŠ¤í¬ë¡¤ ë°©ì§€
        }
        
        // Lightbox ë‹«ê¸°
        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('active');
            document.body.style.overflow = ''; // ìŠ¤í¬ë¡¤ ë³µì›
            currentLightboxCardId = null;
            currentLightboxIndex = 0;
        }
        
        // Lightbox ì´ì „ ì´ë¯¸ì§€
        function prevLightboxImage() {
            if (!currentLightboxCardId) return;
            
            const images = imageData[currentLightboxCardId] || [];
            if (images.length <= 1) return;
            
            currentLightboxIndex = currentLightboxIndex > 0 ? currentLightboxIndex - 1 : images.length - 1;
            
            const lightboxImage = document.getElementById('lightbox-image');
            const lightboxInfo = document.getElementById('lightbox-info');
            const image = images[currentLightboxIndex];
            
            lightboxImage.src = image.src;
            lightboxImage.alt = image.name;
            lightboxInfo.textContent = `${image.name} (${currentLightboxIndex + 1}/${images.length})`;
        }
        
        // Lightbox ë‹¤ìŒ ì´ë¯¸ì§€
        function nextLightboxImage() {
            if (!currentLightboxCardId) return;
            
            const images = imageData[currentLightboxCardId] || [];
            if (images.length <= 1) return;
            
            currentLightboxIndex = currentLightboxIndex < images.length - 1 ? currentLightboxIndex + 1 : 0;
            
            const lightboxImage = document.getElementById('lightbox-image');
            const lightboxInfo = document.getElementById('lightbox-info');
            const image = images[currentLightboxIndex];
            
            lightboxImage.src = image.src;
            lightboxImage.alt = image.name;
            lightboxInfo.textContent = `${image.name} (${currentLightboxIndex + 1}/${images.length})`;
        }
        
        // í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬
        document.addEventListener('keydown', function(e) {
            const lightbox = document.getElementById('lightbox');
            if (!lightbox.classList.contains('active')) return;
            
            if (e.key === 'Escape') {
                closeLightbox();
            } else if (e.key === 'ArrowLeft') {
                prevLightboxImage();
            } else if (e.key === 'ArrowRight') {
                nextLightboxImage();
            }
        });

        // ì´ˆê¸°í™” - ê¸°ì¡´ ì´ë¯¸ì§€ë“¤ì„ imageDataì— ë“±ë¡í•˜ê³  localStorageì—ì„œ ë°ì´í„° ë³µì›
        // ì´ˆê¸° ì´ë¯¸ì§€ ë°ì´í„° (í•˜ë“œì½”ë”© ëŒ€ì‹  ë™ì  ì´ˆê¸°í™”)
        const initialImageData = {
            'landlord-2': [{ src: 'images/17_ê³„ë‹¨ë‚œê°„ì†ì¡ì´ì„¤ì¹˜2.jpg', name: 'ê³„ë‹¨ ë‚œê°„ ì†ì¡ì´', timestamp: '2025-05-29T13:52:00.000Z' }],
            'landlord-3': [{ src: 'images/09_2ì¸µì°½ê³ ëˆ„ìˆ˜í™•ì¸.jpg', name: '2ì¸µ í™”ì¥ì‹¤ ì²œì¥ ëˆ„ìˆ˜', timestamp: '2025-05-29T13:52:00.000Z' }],
            'landlord-4': [{ src: 'images/03_ë°”ë‹¥1.jpg', name: '1ì¸µ ë°”ë‹¥ ë³´ìˆ˜', timestamp: '2025-05-29T13:52:00.000Z' }],
            'landlord-5': [{ src: 'images/04_ë°”ë‹¥2.jpg', name: '2ì¸µ ë°”ë‹¥ ë³´ìˆ˜', timestamp: '2025-05-29T13:52:00.000Z' }],
            'landlord-6': [{ src: 'images/16_4ì¸µí™”ì¥ì‹¤ë°”ë‹¥ëˆ„ìˆ˜í™•ì¸.jpg', name: '4ì¸µ í™”ì¥ì‹¤ ë°”ë‹¥ ëˆ„ìˆ˜', timestamp: '2025-05-29T13:52:00.000Z' }],
            'landlord-8': [{ src: 'images/12_2ì¸µí´ë”©ë„ì–´ìœ ê²©1.jpg', name: '2ì¸µ í´ë”©ë„ì–´ ìœ ê²©1', timestamp: '2025-05-29T13:52:00.000Z' }],
            'landlord-9': [{ src: 'images/13_2ì¸µí´ë”©ë„ì–´ìœ ê²©2.jpg', name: '2ì¸µ í´ë”©ë„ì–´ ìœ ê²©2', timestamp: '2025-05-29T13:52:00.000Z' }],
            'landlord-11': [{ src: 'images/01_switch.jpg', name: 'ìŠ¤ìœ„ì¹˜ ì ê²€', timestamp: '2025-05-29T13:52:00.000Z' }],
            'landlord-12': [{ src: 'images/02_communication.jpg', name: 'í†µì‹ í•¨ ì»¤ë²„', timestamp: '2025-05-29T13:52:00.000Z' }],
            'landlord-13': [{ src: 'images/05_ê³„ë‹¨ì†ì¡ì´.jpg', name: 'ê³„ë‹¨ ì†ì¡ì´ ë³´ìˆ˜', timestamp: '2025-05-29T13:52:00.000Z' }]
        };

        // ì´ˆê¸° ì´ë¯¸ì§€ ë°ì´í„° ë¡œë“œ (ë¹ˆ localStorageì¼ ë•Œë§Œ)
        function loadInitialImages() {
            const stored = localStorage.getItem(STORAGE_KEY);
            if (!stored || Object.keys(JSON.parse(stored || '{}')).length === 0) {
                console.log('LocalStorageê°€ ë¹„ì–´ìˆìŒ. ì´ˆê¸° ì´ë¯¸ì§€ ë°ì´í„° ë¡œë“œ');
                imageData = { ...initialImageData };
                saveDataToStorage();
                
                // UI ì—…ë°ì´íŠ¸
                Object.keys(imageData).forEach(cardId => {
                    updateCarousel(cardId);
                });
                console.log('ì´ˆê¸° ì´ë¯¸ì§€ ë°ì´í„° ë¡œë“œ ì™„ë£Œ');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Firebase ìƒíƒœ ì´ˆê¸°í™”
            if (window.firebaseEnabled) {
                updateFirebaseStatus('âœ… Firebase v11.6.0 ì—°ê²°ë¨ (í•˜ì´ë¸Œë¦¬ë“œ ëª¨ë“œ)');
            } else {
                updateFirebaseStatus('ğŸ“± ë¡œì»¬ ì „ìš© ëª¨ë“œ (Firebase ë¹„í™œì„±í™”)');
            }
            
            // ë¨¼ì € localStorageì—ì„œ ë°ì´í„° ë³µì›
            loadDataFromStorage();
            
            // localStorageê°€ ë¹„ì–´ìˆìœ¼ë©´ ì´ˆê¸° ì´ë¯¸ì§€ ë°ì´í„° ë¡œë“œ
            loadInitialImages();
            
            // ì €ì¥
            saveDataToStorage();
        });
        
        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ë°ì´í„° ì €ì¥ (ì•ˆì „ì¥ì¹˜)
        window.addEventListener('beforeunload', function() {
            saveDataToStorage();
        });
    </script>
</body>
</html>